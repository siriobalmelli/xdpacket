# operations.yaml
# example of exposing operations primitives to user
---
xdpk:
  - iface: enp0s8
  - iface: enp0s3

  - field: mdst  # mac destination
    offt: 0
    len: 6
  - field: msrc  # mac source
    offt: 6
    len: 6

  - rule: all operations
    match:
      - {msrc}: 0a:00:27:00:00:00               # packet->msrc == 0x0A0027000000
      - {msrc: state1}: 0a:00:27:00:00:00       # state1->msrc == 0x0A0027000000
      - {msrc}: {mdst}                          # packet->msrc == packet->mdst
      - {msrc: state1}: {mdst}                  # state1->msrc == packet->mdst
      - {msrc: state1}: {state2}                # state1->msrc == state2->msrc

    write:
      - {msrc}: 0a:00:27:00:00:00               # packet->msrc = 0x0A0027000000
      - {msrc: state1}: 0a:00:27:00:00:00       # state1->msrc = 0x0A0027000000
      - {msrc}: {mdst}                          # packet->msrc = packet->mdst
      - {msrc: state1}: {mdst}                  # state1->msrc = packet->mdst
      - {msrc: state1}: {state2}                # state1->msrc = state2->msrc

  - process: enp0s8
    rules:
      - check src: enp0s3
...
